# Getting Started

Let's take a look into Codeception architecture. We assume you already [installed](http://codeception.com/install) it, and bootstrapped your first test suites. Codeception has generated three of them: unit, functional, acceptance. They are widely described in previous chapter. Inside your /tests folder you will have 3 config files and 3 directories with named by this suites. Suites is independent group of tests with common purpose. 

## Guys

One of the main concepts of Codeception is representation of test as an actions of a person. We call this person a Guy. We have a CodeGuy, who executes functions, and tests the code. We also have a TestGuy, a qualified tester, who tests the application in a whole, with the knowledge of it's internals. And a WebGuy, a user who works with our application through interface we provided.

Each of this guys are PHP classes with the actions they are allowed to do. As you can see each of guys have different abilities. They are not constant, you can extend them. You can create new guys If you like. But one Guy belongs to one suite. You can see guy classes inside the suites directories.

Guy classes are not written, they are generated by the build command:

```
$ codecept build

```

## Writing Sample Scenario

By default tests are written as a narrative scenarios. To make a php file valid scenario it's name should have a Cept suffix. 

Let's say, we created a file "tests/acceptance/SigninCept.php"

``` php
<?php
$I = new WebGuy($scenario);
?>
```

Scenario always starts with Guy class initialization. After that writing a scenario is just like typing "$I->" and choosing a proper action from the auto-completion list.

Let's sign in to our site. We assume we have a 'login' page where we are getting authorized by login and password. Then we are moved to user page, where we see text 'Hello, %username%'. Let's look how this scenario is written in Codeception.

``` php
<?php
$I = new WebGuy($scenario);
$I->wantTo('log in as regular user');
$I->amOnPage('/login');
$I->fillField('Username','davert');
$I->fillField('Password','qwerty');
$I->click('Login');
$I->see('Hello, davert');
?>
```

Before we execute this test, we should make sure the site is running on a local web server. Open the 'tests/acceptance.suite.yml' file and replace the url with url of your web application:

```
    config:
        PhpBrowser:
            url: 'http://myappurl.local'
```

If you don't have web server running, you can use (PHP Built-in Web Server)[http://php.net/manual/en/features.commandline.webserver.php] which is avaible in PHP 5.4. 

After you set proper url, you can run this test with command.

``` 
$ codecept run
```

In output you should see: 

```
Suite acceptance started
Trying log in as regular user (SigninCept.php) - Ok

Suite functional started

Suite unit started


Time: 1 second, Memory: 21.00Mb

OK (1 test, 1 assertions)
```

Let's get a detailed output:

```
$ codecept run acceptance --steps
```

We should see a step-by-step report on performed actions.

```

Suite acceptance started
Trying to log in as regular user (SigninCept.php)
Scenario:
* I am on page "/login"
* I fill field "Username" "davert"
* I fill field "Password" "qwerty"
* I click "Login"
* I see "Hello, davert"
  OK


Time: 0 seconds, Memory: 21.00Mb

OK (1 test, 1 assertions)
```

That was a very simple test that you can reproduce for your site.
By emulating user's action you can test all your site the same way.
Give it a try!

## Modules and Helpers

The actions in Guy classes are taken form modules. With the 'build' command described above, Codeception emulates multiple inheritance. Modules are designed to have one action done with one method. According to DRY principle, If you use same scenario parts in different modules, you can combine them and move to custom module. By default each suite has an empty module, which can extend guy classes. They are stored in 'helpers' directory.

## Bootstrap

Each suite has it's bootstrap file. It's located in suite directory and is named _bootstrap.php_. It will be executed before each test.
Write any set up preparations there.

## Tests

Codeception supports 3 test formats. Besides the Cept, early described Codeception can execute PHPUnit Test files, and the hybrid format, for unit testing - Cept. There is no difference tests of which format will be in suite. But within the PHPUnit tests you can't use Guy classes. 

## Configuration

Codeception has global configuration in codecept.yml and config for each suite. We support .dist configuration files. If you have several developers in a project, put shared setting into codeception.dist.yml, and personal into codeception.yml. Same goes to suite configs. For example, the unit.suite.yml will be merged with unit.suite.dist.yml. 

By default your global configuration file will be this:

```
paths:
	# where the modules stored
    tests: tests

	# logs will, and debug 
	# outputs will be done there
    log: tests/_log

    # directory for fixture data    
    data: tests/_data

    # directory for custom modules (helpers)
    helpers: tests/_helpers
settings:

	# name of bootstrap will be used
	# each bootstrap file should be 
	# inside suite directory.

    bootstrap: _bootstrap.php

    # You can extend suite class, if you need to.
    suite_class: \PHPUnit_Framework_TestSuite

    # by default it's false on Windows
    # use [ANSICON](http://adoxa.110mb.com/ansicon/) to colorize output.
    colors: true

    # Tests (especially functional) can take a lot of memory
    # We set a high limit for them by default.
    memory_limit: 1024M

    # If a log should be written.
    # Every action in test is logged.
    # Logs are kept for 3 days.
    log: true

# Global modules configuration.    
modules:
    config:
        Db:
            dsn: ''
            user: ''
            password: ''
            dump: tests/_data/dump.sql

```

Suite configuration acceptance.yml

```
class_name: WebGuy
modules:
	# enabled modules and helpers
    enabled:
        - PhpBrowser
        - WebHelper
        - Db

	# local module configuration. Overrides the global.        
    config:
    	Db:
    		dsn:
```


## Running Tests

Tests can be started with run command.

```
$ codecept run
```

With the first argument you can run tests from one suite.

```
$ codecept run acceptance
```

To run exactly one test add second argument. Provide a local path to test, from the suite directory.

```
$ codecept run acceptance SigninCept.php

```

There are plenty of options you can use.

* steps - all performed actions will be printed to console.
* debug - additional debug output will be printed.
* colors - turn on colors (if disabled)
* silent - don't show the progress output.
* report - format results in report mode.
* no-exit - don't provide exit codes on finish. This option may be useful for using Codeception with some CI servers like Bamboo.

With next options you can set output in most suitable format.

* html - generate html file with results. It will be stored as 'report.html' in tests/_log.
* xml - generate report in JUnit format for CI services. It will be stored as 'report.xml' in tests/_log.
* tap - generate report in TAP format. It will be stored as 'report.tap.log' in tests/_log.
* json - generate report in Json format. It will be stored as 'report.json' in tests/_log.

Example.

```
$ codecept run --steps --xml --html
```

This command will run all tests for all suites displaying steps and building html and xml report.

### Generators

There are plenty of useful Codeception commands.

* generate:cept *suite* *filename* - Generates sample Cept scenario.
* generate:cest *suite* *filename* - Generates sample Cest test.
* generate:suite *suite* *guy* - Generates new suite with given Guy class name.
* generate:scenarios *suite* - Generates text files with scenarios from tests.


## Conclusion

We took a look into Codeception structure. Most of things you need were already generated by 'bootstrap' command. After you reviewed basic conceptions and configurations, you can start writing your first scenarios. 